# Results


### global trends 
- missing data (separate thing)
- line plot of the the average scores over time (1)
```{r}
# Reading scores data
reading_scores <- list(
  # `2009` = mean(pisa2009$On.the.overall.reading.scale),
  `2012` = filter(pisa2012, Country == 'OECD average')$Mean.score.in.PISA.2012...Reading,
  `2015` = filter(pisa2015, X == 'OECD average')$Mean.score.in.PISA.2015...Reading,
  `2018` = filter(pisa2018, Country == 'OECD average')$Reading.Mean,
  `2022` = filter(pisa2022, Country == 'OECD average')$Reading.Mean
)

reading_scores_df <- data.frame(
  year = as.integer(names(reading_scores)),
  reading_score = as.numeric(unlist(reading_scores)),
  row.names = NULL
)

# Mathematics scores data
math_scores <- list(
  # `2009` = mean(pisa2009$On.the.mathematics.scale),
  `2012` = filter(pisa2012, Country == 'OECD average')$Mean.score.in.PISA.2012...Mathematics,
  `2015` = filter(pisa2015, X == 'OECD average')$Mean.score.in.PISA.2015...Mathematics,
  `2018` = filter(pisa2018, Country == 'OECD average')$Mathematics.Mean,
  `2022` = filter(pisa2022, Country == 'OECD average')$Mathematics.Mean
)

math_scores_df <- data.frame(
  year = as.integer(names(math_scores)),
  math_score = as.numeric(unlist(math_scores)),
  row.names = NULL
)
# Science scores data
science_scores <- list(
  # `2009` = mean(pisa2009$On.the.science.scale),
  `2012` = filter(pisa2012, Country == 'OECD average')$Mean.score.in.PISA.2012...Science,
  `2015` = filter(pisa2015, X == 'OECD average')$Mean.score.in.PISA.2015...Science,
  `2018` = filter(pisa2018, Country == 'OECD average')$Science.Mean,
  `2022` = filter(pisa2022, Country == 'OECD average')$Science.Mean
)

science_scores_df <- data.frame(
  year = as.integer(names(science_scores)),
  science_score = as.numeric(unlist(science_scores)),
  row.names = NULL
)
```

```{r}
# Plotting scores
ggplot(reading_scores_df, aes(year, reading_score)) + 
  geom_point() +
  labs(x = "Year", y = "OECD Average Reading Scores") +
  ggtitle("OECD Average Reading Scores from 2012-2022")

ggplot(math_scores_df, aes(year, math_score)) + 
  geom_point() +
  labs(x = "Year", y = "OECD Average Math Scores") +
  ggtitle("OECD Average Math Scores from 2012-2022")

ggplot(science_scores_df, aes(year, science_score)) + 
  geom_point() +
  labs(x = "Year", y = "OECD Average Science Scores") +
  ggtitle("OECD Average Science Scores from 2012-2022")
```

- interesting to predict what 2022 would be given 2009-2018 (1) 

```{r}
# Reading Predictions
reading_scores_train <- reading_scores_df |>
  filter(year < 2020)
reading_model <- lm(reading_score ~ year, data = reading_scores_train)

# Predict for 2022
predicted_value <- predict(reading_model, newdata = data.frame(year = 2022))
print(predicted_value)

# Plot new model
ggplot(reading_scores_train, aes(year, reading_score)) + 
  geom_point(data=reading_scores_df, aes(year, reading_score)) +
  geom_smooth(method="lm") + 
  geom_abline(intercept = coef(reading_model)[1], slope = coef(reading_model)[2], 
              color = "blue", linewidth = 1) +
  labs(x = "Year", y = "OECD Average Reading Scores") +
  ggtitle("Predicting 2022 OECD Average Reading Score")
```

```{r}
# Math Predictions
math_scores_train <- math_scores_df |>
  filter(year < 2020)
math_model <- lm(math_score ~ year, data = math_scores_train)

# Predict for 2022
predicted_value <- predict(math_model, newdata = data.frame(year = 2022))
print(predicted_value)

# Plot new model
ggplot(math_scores_train, aes(year, math_score)) + 
  geom_point(data=math_scores_df, aes(year, math_score)) +
  geom_smooth(method="lm") + 
  geom_abline(intercept = coef(math_model)[1], slope = coef(math_model)[2], 
              color = "blue", linewidth = 1) +
  labs(x = "Year", y = "OECD Average Math Scores") +
  ggtitle("Predicting 2022 OECD Average Math Score")
```

- GDP for 2018 vs 2022 (1)

- spending for 2018 vs 2022 (1)

---> shit on countries 
---> see if there is a correlation between COVID and GDP, COVID and spending





```{r}
library(dplyr)
library(forcats)
library(vcd)
#https://healthdata.gov/browse?q=school+learning+modalities&sortBy=relevance&pageSize=20

df <- read.csv("data/school_modality.csv") |>
  mutate(
    Learning_Modality = as.factor(Learning_Modality),
    Year = as.factor(Year)
  )

counts <- df |>
  group_by(Year, Learning_Modality) |>
  summarize(Freq = sum(Count), .groups = "drop")

tbl <- xtabs(Freq ~ Year + Learning_Modality, data = counts)

colors_theme <- c("#FFB6B9", "#FAE3D9", "#61C0BF")

mosaic(
  tbl,
  direction = c("v", "h"),
  highlighting = "Learning_Modality",
  highlighting_fill = colors_theme,
  main = "Learning Modality by Year")


```


#### school modality 
- bar graph for the states (1)
- mosaic for the modality (3 categories) (1)

